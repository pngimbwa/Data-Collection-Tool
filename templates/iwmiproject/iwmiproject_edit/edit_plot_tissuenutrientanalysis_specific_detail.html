{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}
    <title>PlantTissueAnalyis</title>
{% endblock %}

{% block main_section %}
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script>
  $(function() {
    $( "#id_date" ).datepicker({
    	onSelect: function() {
        $('#edit_tissuenutrientanalyis_form').formValidation('revalidateField', 'date');
    	}
     })
  });
    
</script>

<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    

<form class="well form-horizontal" action=" " method="post"  id="edit_tissuenutrientanalyis_form">{% csrf_token %} 
<!-- Form Name -->
<fieldset>
<legend>Tissue nutrient analysis...</legend>

{% if user_village %}
<input type="hidden" id="uservillage" name="uservillage" value="{{user_village}}" readonly='readonly' />
{% elif researcher %}
<input type="hidden" id="researcher" name="researcher" value="{{researcher}}" readonly='readonly' />
{% elif user_country %}

{% endif %}
<label class="warning" for="message" id="message" align='center' style="color: red"><small><i>{{message}}</i></small></label>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.date.errors }}
    <label for="date" class="col-md-4 control-label">Date:</label>
        <div class="col-md-4 selectContainer">
        {{ tissuenutrientanalysis_form.date }}
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.farm.errors }}
    <label for="farm" class="col-md-4 control-label">Farm:</label>
        <div class="col-md-4 selectContainer">
        {{ tissuenutrientanalysis_form.farm }}
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.plotID.errors }}
    <label for="plotID" class="col-md-4 control-label">Plot:</label>
        <div class="col-md-4 selectContainer">
        {{ tissuenutrientanalysis_form.plotID }}
        </div>
</div>

<div class="form-group" id='Crop'> 
    {{ tissuenutrientanalysis_form.Crop.errors }}
    <label for="Crop" class="col-md-4 control-label">Crop:</label>
        <div class="col-md-4 selectContainer">
             {{ tissuenutrientanalysis_form.Crop }}
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.plant_tissue_part.errors }}
    <label for="plant_tissue_part" class="col-md-4 control-label">Plant tissue part:</label>
        <div class="col-md-4 selectContainer">
        {{ tissuenutrientanalysis_form.plant_tissue_part }}
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.plantnumber.errors }}
    <label for="plantnumber" class="col-md-4 control-label">Plant number:</label>
        <div class="col-md-4 selectContainer">
        {{ tissuenutrientanalysis_form.plantnumber }}
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.bed_number.errors }}
    <label for="bed_number" class="col-md-4 control-label">Bed number:</label>
        <div class="col-md-4 selectContainer">
        {{ tissuenutrientanalysis_form.bed_number }}
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.freshweight.errors }}
    <label for="freshweight" class="col-md-4 control-label">Fresh weight:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
            {{ tissuenutrientanalysis_form.freshweight }}<span class="input-group-addon">kg</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.dryweight.errors }}
    <label for="dryweight" class="col-md-4 control-label">Dry weight:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
            {{ tissuenutrientanalysis_form.dryweight }}<span class="input-group-addon">kg</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.n.errors }}
    <label for="n" class="col-md-4 control-label">Nitrogen:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
            {{ tissuenutrientanalysis_form.n }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.p.errors }}
    <label for="p" class="col-md-4 control-label">Posphorus:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
            {{ tissuenutrientanalysis_form.p }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.k.errors }}
    <label for="k" class="col-md-4 control-label">Potassium:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
            {{ tissuenutrientanalysis_form.k }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.s.errors }}
    <label for="s" class="col-md-4 control-label">Sulphur:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
            {{ tissuenutrientanalysis_form.s }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.mg.errors }}
    <label for="mg" class="col-md-4 control-label">Magnesium:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
            {{ tissuenutrientanalysis_form.mg }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.ca.errors }}
    <label for="ca" class="col-md-4 control-label">Calcium:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
             {{ tissuenutrientanalysis_form.ca }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.fe.errors }}
    <label for="fe" class="col-md-4 control-label">Iron:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
             {{ tissuenutrientanalysis_form.fe }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

<div class="form-group"> 
    {{ tissuenutrientanalysis_form.zn.errors }}
    <label for="zn" class="col-md-4 control-label">Zinc:</label>
        <div class="col-md-4 selectContainer">
            <div class="input-group">
             {{ tissuenutrientanalysis_form.zn }}<span class="input-group-addon">%</span>
            </div>
        </div>
</div>

</fieldset>

<label for="message" style="color:#636363"><small>Note: If data is not available please enter -999 and not 0‚Äù</small></label>
 
<!-- Success message -->
<div class="alert alert-success" role="alert" id="success_message">Success <i class="glyphicon glyphicon-thumbs-up"></i> Thanks for contacting us, we will get back to you shortly.</div>

<!-- Button -->
<div class="form-group">
  <label class="col-md-4 control-label"></label>
  <div class="col-md-4">
    <button type="submit" class="btn btn-default" >Submit</button>
  </div>
</div>
</form>
    
    </div><!-- /.container -->
{% endblock %}

{% block extended_javascripts_code %}
	<script>
    $(document).ready(function () {
    $('#edit_tissuenutrientanalyis_form').formValidation({
        framework: 'bootstrap',
        icon: {
            //valid: 'glyphicon glyphicon-ok',
            //invalid: 'glyphicon glyphicon-remove',
            validating: 'glyphicon glyphicon-refresh'
        },
        fields: {
            farm: {
                validators: {
                    notEmpty: {
                        message: 'Please select farm' }
                        }
                    },
            plotID: {
                validators: {
                    notEmpty: {
                        message: 'Please select field' }
                        }
                    },
            date: {
                validators: {
                  date: {
                            format: 'MM/DD/YYYY',
                            message: 'The date is not a valid'},
                    notEmpty: {
                        message: 'Please fill the date' }
                        }
                    },
            plant_tissue_part: {
                validators: {
                    notEmpty: {
                        message: 'Please choose plant tissue part' }
                        }
                    },
            plantnumber: {
                validators: {
                    notEmpty: {
                        message: 'Please choose plant number' }
                        }
                    },
                    
            bed_number: {
                validators: {
                    notEmpty: {
                        message: 'Please choose bed number' }
                        }
                    },
            freshweight: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill fresh weight' }
                }
            },
            
            dryweight: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill dry weight' }
                }
            },
            
            n: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured nitrogen amount' }
                }
            },
            p: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured phosphorus amount' }
                }
            },
            
            k: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured potassium amount' }
                }
            },
            
            s: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured sulphur amount' }
                }
            },
            
            mg: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured magnesium amount' }
                }
            },
            
            ca: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured calcium amount' }
                }
            },
            
            fe: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured iron amount' }
                }
            },
            zn: {
                validators:{
                        numeric: {
                            message: 'The value is not a number',
                            thousandsSeparator: '',
                            decimalSeparator: '.'
                        },
                        notEmpty:{
                                message:'Please fill measured zinc amount' }
                }
            },
            
            
            
        }
    })
});
</script>

<script>
$(document).ready(function() {
  $("#id_farm").change(function() {
    if ($(this).val() == '') {
      $("#id_plot").html("<option>Choose field..</option>");
      $("#id_plot").attr('disabled', true);
      }
      else {
        var url = "/plot/" + $(this).val() + "/plots";
        $.getJSON(url, function(plots) {
        var options = '<option value="">Choose plot..</option>';
        for (var i = 0; i < plots.length; i++) {
          options += '<option value="' + plots[i].pk + '">' + plots[i].fields['plotID']  + '</option>';
        }
        $("#id_plot").html(options);
        $("#id_plot option:first").attr('selected', 'selected');
        $("#id_plot").attr('disabled', false);
      });
    }
  });
});
</script>
<script>

$(window).load(function(){
  var url = "/get_farmer_name/" + $('#id_farm').val() + "/get_farmer_name";
  $.getJSON(url, function(farmer_name) {
    //alert(farmer_name);
    var options = '<option value="' + farmer_name[0] + '">' + farmer_name[1] + ' ' + farmer_name[2] + ' ' + farmer_name[3] + '</option>';
    $("#id_farm").html(options);
    $("#id_farm option:selected").attr('selected', 'selected');
  })
});

$(window).load(function(){
  var url = "/get_plot_name/" + $('#id_plotID').val() + "/get_plot_name";
  $.getJSON(url, function(plot_name) {
    var options = '<option value="' + plot_name[0] + '">' + plot_name[1] + '</option>';
    $("#id_plotID").html(options);
    $("#id_plotID option:selected").attr('selected', 'selected');
  })
});

</script>
<script>
$(window).load(function() {
  if ($('#id_farm').val() == '' || $('#id_plot').val() == '') {
      $('#Crop').hide();
	  $('#plot_message').hide();
    }
  else {
     if ($('#croppingsystem').val() == 'Monocropping') {
        $('#Crop').hide();
        $('#id_Crop').val();
     }
     else if ($('#croppingsystem').val() == 'Intercropping')  {
        $('#Crop').show();
        $('#id_Crop').val();
     }
  }
});

$(document).ready(function() {
  $("#id_farm,#id_plot").change(function() {
    if ($('#id_farm').val() == '' || $('#id_plot').val() == '') {
      $('#Crop').hide();
    }
    else{
      var url = "/plotmanagement_info/" + $('#id_farm').val() + '/' + $('#id_plot').val() + "/plotmanagement_info";
      $.getJSON(url, function(plotmanagement_info) {
       var  croppingsystem = plotmanagement_info[0];
		if (croppingsystem == 'Monocropping') {
		  crop = plotmanagement_info[2][0];
		  $('#Crop').hide();
		  $('#id_Crop').html($('<option>', {
				  value: crop,
				  text: crop,
		  }));
		  $('select[name=Crop] option:eq(1)').attr('selected', 'selected');
       }
       else if (croppingsystem == 'Intercropping') {

        $('#Crop').show();
        var options = '<option value="">Choose crop..</option>';
        crops = plotmanagement_info[2];
        for (var i = 0; i < crops.length; i++) {
          options += '<option value="' + crops[i] + '">' + crops[i] + '</option>';
          }
          $("#id_Crop").html(options);
          $("#id_Crop option:selected").attr('selected', 'selected');  
       }
	
      })
    }
  })
});
</script>
{% endblock %}